<div class="contentGpCategory contentGpCategoryCategory">
  <%- unless @docs.empty? -%>
  <section class="category<%= @category.name.try(:camelize) %>">
    <%- if @content.feed_display? -%>
    <ul class="feed">
      <li><%= link_to 'RSS' , "index.rss" , class: 'feedRss', title: 'RSSフィードを取得' %></li>
      <li><%= link_to 'Atom', "index.atom", class: 'feedAtom', title: 'Atomフィードを取得' %></li>
    </ul>
    <%- end -%>
    <div class="docs">
      <ul>
        <%- @docs.each do |doc| -%>
        <li><%= doc_replace(doc, @content.category_doc_style, @content.date_style, @content.time_style) %></li>
        <%- end -%>
      </ul>
    </div>
    <%- if @docs.total_entries > @docs.per_page -%>
    <div class="more">
      <%= link_to '一覧へ', "#{@category.public_uri}more.html" %>
    </div>
    <%- end -%>
  </section>
  <%- end -%>

  <%- @category = GpCategory::CategoriesPreloader.new(@category).preload(:public_children_and_public_node_ancestors) -%>
  <%- @category.public_children.each do |child| -%>
  <section class="category<%= child.name.try(:camelize) %> classification">
    <h2><%= link_to child.title, child.public_uri %></h2>
    <%-
      docs = child.docs.paginate(page: 1, per_page: @content.category_docs_number)
      docs = GpArticle::DocsPreloader.new(docs).preload(:public_node_ancestors)
    -%>
    <%- unless docs.empty? -%>
    <div class="docs">
      <ul>
        <%- docs.each do |doc| -%>
        <li><%= doc_replace(doc, @content.category_doc_style, @content.date_style, @content.time_style) %></li>
        <%- end -%>
      </ul>
    </div>
    <%- end -%>
    <%- if docs.total_entries > @content.category_docs_number -%>
    <div class="more">
      <%= link_to '一覧へ', "#{child.public_uri}more.html" %>
    </div>
    <%- end -%>
  </section>
  <%- end -%>
</div>
